<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebSocket Notification Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2rem;
    }

    h2 {
      margin-bottom: 1rem;
    }

    button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      margin-bottom: 1rem;
      cursor: pointer;
    }

    #output {
      background-color: #f3f3f3;
      padding: 1rem;
      border-radius: 6px;
      font-family: monospace;
      white-space: pre-line;
      margin-top: 1rem;
    }

    .status {
      font-weight: bold;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>

  <h2>WebSocket Notification Test</h2>
  <button onclick="sendReset()">Reset Pending</button>

  <div id="output">Connecting...</div>

  <script>
    const output = document.getElementById("output");
    const socket = new WebSocket("wss://api-paiv.blvcksapphire.com/ws/notifications/2");

    socket.onopen = () => {
      console.log("WebSocket connected.");
      output.innerText = "WebSocket connected. Waiting for notifications...";
    };

    socket.onmessage = (event) => {
      console.log(" Message received:", event.data);

      try {
        const data = JSON.parse(event.data);
        output.innerText = `
 Notification Update:
───────────────────────
Pending  → ${data.pending}
Approved → ${data.approved}
Rejected → ${data.rejected}
Flagged  → ${data.flagged}
        `.trim();
      } catch (err) {
        output.innerText = "⚠️ Error parsing data: " + event.data;
      }
    };

    socket.onclose = () => {
      console.log(" WebSocket disconnected.");
      output.innerText = " WebSocket disconnected.";
    };

    function sendReset() {
      if (socket.readyState === WebSocket.OPEN) {
        socket.send("reset_pending");
        output.innerText = "Reset command sent.";
      } else {
        output.innerText = " WebSocket not open.";
      }
    }
  </script>
</body>
</html>
